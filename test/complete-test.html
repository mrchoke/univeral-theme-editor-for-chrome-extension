<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1.0"
  >
  <title>Universal Theme Editor - Complete Features Test</title>
  <link
    rel="stylesheet"
    href="style.css"
  >
  <style>
    body {
      font-family: Arial, sans-serif;
      line-height: 1.6;
      margin: 40px;
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
      min-height: 100vh;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
    }

    .test-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin: 20px 0;
    }

    .test-box {
      padding: 20px;
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      border: 2px solid #eee;
      transition: all 0.3s ease;
    }

    .test-box:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
    }

    .test-box h3 {
      margin: 0 0 15px 0;
      color: #333;
      border-bottom: 2px solid #007bff;
      padding-bottom: 8px;
    }

    .feature-list {
      list-style: none;
      padding: 0;
    }

    .feature-list li {
      padding: 8px 0;
      border-bottom: 1px solid #eee;
    }

    .feature-list li:last-child {
      border-bottom: none;
    }

    .badge {
      display: inline-block;
      padding: 4px 8px;
      background: #007bff;
      color: white;
      border-radius: 12px;
      font-size: 12px;
      font-weight: bold;
      margin-left: 10px;
    }

    .badge.new {
      background: #28a745;
    }

    .badge.improved {
      background: #ffc107;
      color: #333;
    }

    .text-demo {
      font-size: 24px;
      font-weight: bold;
      color: #2c3e50;
      text-align: center;
      margin: 20px 0;
      padding: 20px;
      background: #ecf0f1;
      border-radius: 8px;
    }

    .gradient-demo {
      height: 100px;
      background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
      border-radius: 8px;
      margin: 15px 0;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
    }

    .info-panel {
      background: #e7f3ff;
      border: 1px solid #b3d9ff;
      border-radius: 8px;
      padding: 20px;
      margin: 20px 0;
      border-left: 4px solid #007bff;
    }

    .warning-panel {
      background: #fff3cd;
      border: 1px solid #ffeaa7;
      border-radius: 8px;
      padding: 20px;
      margin: 20px 0;
      border-left: 4px solid #ffc107;
    }

    .os-info {
      background: #f8f9fa;
      border-radius: 8px;
      padding: 15px;
      margin: 15px 0;
      font-family: monospace;
      border: 1px solid #dee2e6;
    }
  </style>
</head>

<body>
  <div class="container">
    <header style="text-align: center; margin-bottom: 40px;">
      <h1>🎨 Universal Theme Editor - Complete Features Test</h1>
      <p style="font-size: 18px; color: #666;">Test all new features: Gradient backgrounds, Shadow effects,
        Cross-platform compatibility & UI improvements</p>
    </header>

    <div class="info-panel">
      <h3>🚀 Testing Instructions</h3>
      <ol>
        <li>Click the 🎨 button (bottom-right) to open the theme editor</li>
        <li>Select "Start Editing" or hold <strong><span id="modifier-key">Alt</span> + Click</strong> on any element
          below</li>
        <li>Test new features in the toolbox that opens</li>
        <li>Try resizing both the options dialog and toolbox</li>
      </ol>
    </div>

    <div class="os-info">
      <strong>🖥️ Detected OS:</strong> <span id="detected-os">Detecting...</span><br>
      <strong>⌨️ Modifier Key:</strong> <span id="modifier-display">Loading...</span>
    </div>

    <div class="test-grid">
      <!-- Text Shadow Testing -->
      <div
        class="test-box"
        id="text-shadow-test"
      >
        <h3>📝 Text Shadow Testing</h3>
        <div class="text-demo">
          Sample Text for Shadow Testing
        </div>
        <ul class="feature-list">
          <li>✅ Enable/Disable toggle<span class="badge new">NEW</span></li>
          <li>🎨 Color picker & text input</li>
          <li>📏 Distance slider (0-20px)</li>
          <li>🧭 Direction slider (0-360°)</li>
          <li>💫 Blur amount (0-20px)</li>
        </ul>
      </div>

      <!-- Box Shadow Testing -->
      <div
        class="test-box"
        id="box-shadow-test"
        style="margin: 10px;"
      >
        <h3>📦 Box Shadow Testing</h3>
        <div style="padding: 20px; background: #f8f9fa; border-radius: 8px; margin: 15px 0;">
          This entire box can have shadows
        </div>
        <ul class="feature-list">
          <li>✅ Enable/Disable toggle<span class="badge new">NEW</span></li>
          <li>🎨 Color picker & text input</li>
          <li>📏 Distance slider (0-30px)</li>
          <li>🧭 Direction slider (0-360°)</li>
          <li>💫 Blur amount (0-30px)</li>
        </ul>
      </div>

      <!-- Gradient Background Testing -->
      <div
        class="test-box"
        id="gradient-test"
      >
        <h3>🌈 Gradient Background Testing</h3>
        <div class="gradient-demo">
          Gradient Demo Area
        </div>
        <ul class="feature-list">
          <li>✅ Gradient mode toggle<span class="badge new">NEW</span></li>
          <li>🎨 Color 1 & Color 2 pickers</li>
          <li>🧭 Direction (0-360°)</li>
          <li>📍 Position (0-100%)</li>
          <li>👁️ Real-time preview</li>
        </ul>
      </div>

      <!-- UI Improvements Testing -->
      <div
        class="test-box"
        id="ui-improvements-test"
      >
        <h3>🛠️ UI Improvements Testing</h3>
        <p>Test the following improvements:</p>
        <ul class="feature-list">
          <li>📏 Resizable dialogs<span class="badge improved">FIXED</span></li>
          <li>🚫 No auto-close on resize<span class="badge improved">FIXED</span></li>
          <li>📤 Export button visible<span class="badge improved">FIXED</span></li>
          <li>⚡ Performance optimized<span class="badge improved">FIXED</span></li>
          <li>🖥️ Cross-platform keys<span class="badge new">NEW</span></li>
        </ul>
      </div>

      <!-- Mixed Testing Area -->
      <div
        class="test-box"
        id="mixed-test"
        style="background: #fff8e1;"
      >
        <h3>🧪 Mixed Features Testing</h3>
        <p style="font-size: 18px; font-weight: bold; color: #e65100;">
          Text with potential shadows
        </p>
        <div style="padding: 15px; margin: 10px 0; background: white; border-radius: 4px;">
          Box for shadow testing
        </div>
        <p>Try combining multiple effects:</p>
        <ul class="feature-list">
          <li>🎨 Gradient + Box Shadow</li>
          <li>📝 Text Shadow + Color Change</li>
          <li>🔄 Reset & Undo functions</li>
          <li>📤 Export final CSS</li>
        </ul>
      </div>

      <!-- Performance Testing -->
      <div
        class="test-box"
        id="performance-test"
      >
        <h3>⚡ Performance Testing</h3>
        <p>Test these scenarios to ensure good performance:</p>
        <ul class="feature-list">
          <li>🔄 Rapid slider changes</li>
          <li>🎨 Multiple color adjustments</li>
          <li>📏 Resizing dialogs frequently</li>
          <li>🖱️ Clicking outside dialogs</li>
          <li>🔀 Switching between elements</li>
        </ul>
        <div style="margin-top: 15px; padding: 10px; background: #e8f5e8; border-radius: 4px; font-size: 14px;">
          <strong>✅ Should NOT experience:</strong><br>
          • Maximum call stack errors<br>
          • Infinite loops<br>
          • Browser freezing<br>
          • Memory leaks
        </div>
      </div>
    </div>

    <div class="warning-panel">
      <h3>⚠️ Known Issues (Should be Fixed)</h3>
      <ul>
        <li><del>Options dialog closes when resizing</del> ✅ <strong>FIXED</strong></li>
        <li><del>Export CSS button disappears in toolbox</del> ✅ <strong>FIXED</strong></li>
        <li><del>Infinite recursion in event listeners</del> ✅ <strong>FIXED</strong></li>
        <li><del>Alt key showing on macOS instead of Option</del> ✅ <strong>FIXED</strong></li>
      </ul>
    </div>

    <div class="info-panel">
      <h3>💡 Pro Tips for Testing</h3>
      <ul>
        <li><strong>Gradient Testing:</strong> Try different angles (0°, 45°, 90°, 180°, 270°) and positions</li>
        <li><strong>Shadow Testing:</strong> Test extreme values and different angles</li>
        <li><strong>Resize Testing:</strong> Drag corners and edges of dialogs</li>
        <li><strong>Performance:</strong> Make rapid changes to test responsiveness</li>
        <li><strong>Cross-platform:</strong> Verify correct key names show for your OS</li>
      </ul>
    </div>
  </div>

  <!-- Load all extension scripts -->
  <script src="js/globals.js"></script>
  <script src="js/ui-components.js"></script>
  <script src="js/event-listeners.js"></script>
  <script src="js/element-handlers.js"></script>
  <script src="js/style-applier.js"></script>
  <script src="js/toolbox-populators.js"></script>
  <script src="js/options-panel.js"></script>
  <script src="js/main.js"></script>

  <script>
    // Initialize extension on page load
    document.addEventListener('DOMContentLoaded', function () {
      console.log('🎨 Initializing Universal Theme Editor complete test...')
      initializeExtension()

      // Auto-enable debug mode for testing
      debugMode = true
      localStorage.setItem('ote-debug-mode', 'true')

      // Update OS and modifier key info
      const detectedOS = detectOS()
      const modifierKey = getModifierKeyName()

      document.getElementById('detected-os').textContent = detectedOS
      document.getElementById('modifier-display').textContent = modifierKey
      document.getElementById('modifier-key').textContent = modifierKey

      console.log('🖥️ Detected OS:', detectedOS)
      console.log('⌨️ Modifier key:', modifierKey)

      // Test shadow calculations
      function testShadowCalculations () {
        console.log('🧪 Testing shadow calculations...')

        // Test different angles
        const testAngles = [0, 45, 90, 135, 180, 225, 270, 315]
        testAngles.forEach(angle => {
          const angleRad = (angle * Math.PI) / 180
          const distance = 5
          const x = Math.round(Math.cos(angleRad) * distance)
          const y = Math.round(Math.sin(angleRad) * distance)
          console.log(`Angle ${angle}°: x=${x}, y=${y}`)
        })
      }

      testShadowCalculations()

      // Quick test functions
      window.testGradient = function (elementId, color1, color2, angle, position) {
        const element = document.getElementById(elementId)
        if (element) {
          const gradient = `linear-gradient(${angle}deg, ${color1} 0%, ${color2} ${position}%)`
          element.style.background = gradient
          console.log(`🎨 Applied gradient to ${elementId}:`, gradient)
        }
      }

      window.testTextShadow = function (elementId, x, y, blur, color) {
        const element = document.getElementById(elementId)
        if (element) {
          const shadow = `${x}px ${y}px ${blur}px ${color}`
          element.style.textShadow = shadow
          console.log(`📝 Applied text shadow to ${elementId}:`, shadow)
        }
      }

      window.testBoxShadow = function (elementId, x, y, blur, color) {
        const element = document.getElementById(elementId)
        if (element) {
          const shadow = `${x}px ${y}px ${blur}px ${color}`
          element.style.boxShadow = shadow
          console.log(`📦 Applied box shadow to ${elementId}:`, shadow)
        }
      }

      // Example tests
      console.log('🚀 Quick test functions available:')
      console.log('• testGradient("gradient-test", "#ff0000", "#0000ff", 45, 50)')
      console.log('• testTextShadow("text-shadow-test", 2, 2, 4, "#333")')
      console.log('• testBoxShadow("box-shadow-test", 0, 4, 8, "rgba(0,0,0,0.3)")')

      console.log('✅ Complete test environment ready!')
    });
  </script>
</body>

</html>